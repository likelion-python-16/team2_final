{% extends "base.html" %}
{% load static %}
{% block title %}My Profile{% endblock %}
{% block extra_head %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
{% endblock %}
{% block extra_js %}
  {{ block.super }}
  <script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}
{% block content %}
<div class="profile-shell">
  <section class="profile-hero">
    <div class="profile-hero__avatar">{{ avatar_initial }}</div>
    <div>
      <h1>{{ profile.user.nickname|default:profile.user.username }}</h1>
      <p>Health journey started 2 weeks ago</p>
    </div>
  </section>

  <section class="profile-card">
    <header class="profile-card__header">
      <span class="profile-card__icon">ðŸ‘¤</span>
      <span>Health Overview</span>
    </header>
    <div class="profile-overview">
      <div class="profile-overview__item profile-overview__item--weight">
        <strong>{{ profile.weight_kg|default:"-" }} <small>kg</small></strong>
        <span>Current Weight</span>
      </div>
      <div class="profile-overview__item profile-overview__item--height">
        <strong>{{ profile.height_cm|default:"-" }} <small>cm</small></strong>
        <span>Height</span>
      </div>
      <div class="profile-overview__item profile-overview__item--bmi">
        <strong>{{ bmi|floatformat:1 }}</strong>
        <span>BMI</span>
      </div>
      <div class="profile-overview__item profile-overview__item--age">
        <strong>{{ profile.age|default:"-" }}</strong>
        <span>Years Old</span>
      </div>
    </div>
  </section>

  <section class="profile-card">
    <header class="profile-card__header">
      <span class="profile-card__icon">ðŸŽ¯</span>
      <span>Current Goals</span>
    </header>
    <div class="profile-goal">
      <div>
        <span class="label">Primary Goal</span>
        <span class="goal-pill goal-pill--primary">{{ goal_label }}</span>
      </div>
      <div>
        <span class="label">Activity Level</span>
        <span class="goal-pill goal-pill--secondary">{{ activity_label }}</span>
      </div>
    </div>
    <a class="health-button-secondary" href="{% url 'user_setup' %}">Update Goals</a>
  </section>

  <section class="profile-card">
    <header class="profile-card__header">
      <span>This Week's Progress</span>
      <span class="profile-progress__percent">{{ weekly_stats.goal_progress }}%</span>
    </header>
    <div class="profile-progress">
      <div class="profile-progress__ring">
        {% include "partials/progress_ring.html" with wrapper_class="progress-ring--mini" progress=workout_percent value=workout_label label="Workouts" color="primary" %}
        <small>this week</small>
      </div>
      <div>
        <strong>{{ weekly_stats.avg_calories }}</strong>
        <span>Avg Calories</span>
        <small>Daily Intake</small>
      </div>
      <div>
        <strong>{{ weekly_stats.streak_days }}</strong>
        <span>Day Streak</span>
        <small>Current</small>
      </div>
      <div>
        <strong>{{ weekly_stats.goal_progress }}%</strong>
        <span>Goal Progress</span>
        <small>This Month</small>
      </div>
    </div>
  </section>

  <section class="profile-card">
    <header class="profile-card__header">
      <span>Achievements</span>
    </header>
    <div class="profile-achievements">
      {% for achievement in achievements %}
        <article class="profile-achievement{% if achievement.earned %} is-earned{% endif %}">
          <div class="profile-achievement__icon">{{ achievement.icon }}</div>
          <div>
            <h4>{{ achievement.name }}</h4>
            <p>{{ achievement.desc }}</p>
          </div>
        </article>
      {% endfor %}
    </div>
  </section>

  <section class="profile-card">
    <header class="profile-card__header">
      <span>Settings</span>
    </header>
    <ul class="profile-settings">
      <li><a href="#">Notification Preferences</a></li>
      <li><a href="#">Privacy Settings</a></li>
      <li><a href="#">Data Export</a></li>
    </ul>
  </section>
</div>
{% endblock %}
