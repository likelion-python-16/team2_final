global:
  scrape_interval: 15s
  evaluation_interval: 15s
  scrape_timeout: 10s

scrape_configs:
  # 1) 자기 자신(Prometheus) 모니터링
  - job_name: "prometheus"
    metrics_path: /metrics
    static_configs:
      - targets:
          - team2_local_prometheus:9090

  # 2) 로컬 Blackbox 프로브 (/api/health)
  - job_name: "blackbox_local"
    metrics_path: /probe
    params:
      module:
        - http_2xx
    static_configs:
      - targets:
          - http://host.docker.internal:8000/api/health/
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: team2_local_blackbox:9115

  # 3) Django /metrics 내부 계측 (api 컨테이너)
  - job_name: "django"
    metrics_path: /metrics
    static_configs:
      - targets:
          - api:8000

  # 4) Node Exporter (CPU / 메모리 / 네트워크 등 시스템 메트릭)
  - job_name: "node_exporter"
    metrics_path: /metrics
    static_configs:
      - targets:
          - node_exporter:9100
